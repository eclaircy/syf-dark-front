<template>
    <div id="sankey-container"></div>
</template>

<script>
export default {
    methods:{
        showSankey(originEdges){
            const edges = []; //新建一个数组，如果直接对原数组赋值的话，会直接改变原数组，导致图无法正确显示。
            for(var key in originEdges){
                edges.push({});
                edges[key]["value"]=1;
                //将id替换为name
                this.graph.nodes.forEach(node => {
                    if(node["id"]==originEdges[key]["source"]){
                        edges[key]["source"] = node.properties["name"];
                    }
                    if(node["id"]==originEdges[key]["target"]){
                        edges[key]["target"] = node.properties["name"];
                    }
                });
            }
            const sankey = new Sankey('sankey-container', {
            data: edges,
            sourceField: 'source',
            targetField: 'target',
            weightField: 'value',
            nodeWidthRatio: 0.008,
            nodePaddingRatio: 0.03,
            });
            sankey.render();
        }
    },
    mounted(){
        // this.showSankey()
    }
}
</script>