<template>
    <div id="node-count-pie"></div>
</template>

<script>
import { Pie,G2 } from '@antv/g2plot';
const G = G2.getEngine('canvas');
export default {
    // props: {
    //     nodeCount: {
    //         type: Array,
    //         required: true
    //     }
    // },
    props:["nodeCount"],
    watch: {
        nodeCount: function(newVal, oldVal) {
        // 当 graphData 数据变化时执行渲染的逻辑
            this.showPie();
        }
    },
    methods: {
        showPie(){      
            // const data = [
            // { type: '域名', value: 27 },
            // { type: 'IP', value: 25 },
            // { type: '公司', value: 18 },
            // { type: '人员', value: 15 },
            // { type: '跳转链接', value: 10 },
            // { type: '其他', value: 5 },
            // ];
            const data = this.nodeCount;
            const piePlot = new Pie('node-count-pie', {
                appendPadding: 10,
                data,
                angleField: 'value',
                colorField: 'type',
                radius: 1,
                innerRadius: 0.6,
                // label: {
                //     type: 'inner',
                //     offset: '-50%',
                //     content: '{value}',
                //     style: {
                //     textAlign: 'center',
                //     fontSize: 10,
                //     },
                // },
                label: {
                    type: 'spider',
                    labelHeight: 40,
                    formatter: (data, mappingData) => {
                    const group = new G.Group({});
                    group.addShape({
                        type: 'circle',
                        attrs: {
                        x: 0,
                        y: 0,
                        width: 40,
                        height: 50,
                        r: 5,
                        fill: mappingData.color
                        },
                    });
                    group.addShape({
                        type: 'text',
                        attrs: {
                        x: 10,
                        y: 8,
                        text: `${data.type}`,
                        fill: mappingData.color,
                        },
                    });
                    group.addShape({
                        type: 'text',
                        attrs: {
                        x: 0,
                        y: 25,
                        text: `${data.value}个`,
                        fill: mappingData.color,
                        fontWeight: 700,
                        },
                    });
                    return group;
                    },
                },
                interactions: [{ type: 'element-selected' }, { type: 'element-active' }],
                statistic: {
                    title: false,
                    content: {
                    style: {
                        whiteSpace: 'pre-wrap',
                        overflow: 'hidden',
                        textOverflow: 'ellipsis',
                    },
                    content: '',
                    },
                },
            });

            piePlot.render();

        }
    },
    mounted(){

    }
}
</script>