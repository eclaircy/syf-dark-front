<template>
    <div id="node-count-pie"></div>
    <!-- <div id="seat-container"></div> -->
</template>

<script>
import { Pie,G2 } from '@antv/g2plot';
const G = G2.getEngine('canvas');


// 导入其他需要的模块


// 导入其他需要的模块

export default {
    // props: {
    //     nodeCount: {
    //         type: Array,
    //         required: true
    //     }
    // },
    props:["nodeCount"],
    watch: {
        nodeCount: function(newVal, oldVal) {
        // 当 graphData 数据变化时执行渲染的逻辑
            if(newVal!=null&&newVal.length>0){
                this.showPie();
            }
           
        }
    },
    methods: {
        showPie(){      
            // const data = [
            // { type: '域名', value: 25 },
            // { type: 'IP', value: 6 },
            // { type: '公司', value: 4 },
            // { type: '人员', value: 4 },
            // { type: '跳转链接', value: 3 },
            // ];
            const data = this.nodeCount;
            const piePlot = new Pie('node-count-pie', {
                appendPadding: 10,
                data,
                angleField: 'value',
                colorField: 'type',
                radius: 1,
                innerRadius: 0.6,
                // label: {
                //     type: 'inner',
                //     offset: '-50%',
                //     content: '{value}',
                //     style: {
                //     textAlign: 'center',
                //     fontSize: 10,
                //     },
                // },

                label: {
                    type: 'spider',
                    labelHeight: 40,
                    formatter: (data, mappingData) => {
                    const group = new G.Group({});
                    group.addShape({
                        type: 'circle',
                        attrs: {
                        x: 0,
                        y: 0,
                        width: 40,
                        height: 50,
                        r: 5,
                        fill: mappingData.color
                        },
                    });
                    group.addShape({
                        type: 'text',
                        attrs: {
                        x: 10,
                        y: 8,
                        text: `${data.type}`,
                        fill: mappingData.color,
                        },
                    });
                    group.addShape({
                        type: 'text',
                        attrs: {
                        x: 0,
                        y: 25,
                        text: `${data.value}个`,
                        fill: mappingData.color,
                        fontWeight: 700,
                        },
                    });
                    return group;
                    },
                },
                interactions: [{ type: 'element-selected' }, { type: 'element-active' }],
                statistic: {
                    title: false,
                    content: {
                    style: {
                        whiteSpace: 'pre-wrap',
                        overflow: 'hidden',
                        textOverflow: 'ellipsis',
                    },
                    content: '',
                    },
                },
            });

            piePlot.render();
        },

    },
    mounted(){
        // this.showPie()
    }
}
</script>

<style scoped>
.highcharts-figure,
.highcharts-data-table table {
  min-width: 320px;
  max-width: 800px;
  margin: 1em auto;
}

.highcharts-data-table table {
  font-family: Verdana, sans-serif;
  border-collapse: collapse;
  border: 1px solid #ebebeb;
  margin: 10px auto;
  text-align: center;
  width: 100%;
  max-width: 500px;
}

.highcharts-data-table caption {
  padding: 1em 0;
  font-size: 1.2em;
  color: #555;
}

.highcharts-data-table th {
  font-weight: 600;
  padding: 0.5em;
}

.highcharts-data-table td,
.highcharts-data-table th,
.highcharts-data-table caption {
  padding: 0.5em;
}

.highcharts-data-table thead tr,
.highcharts-data-table tr:nth-child(even) {
  background: #f8f8f8;
}

.highcharts-data-table tr:hover {
  background: #f1f7ff;
}

input[type="number"] {
  min-width: 50px;
}
</style>